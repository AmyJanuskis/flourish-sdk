!function(){"use strict";var t,a;function s(){if(null==t){var e=function(){var e=window.location;"about:srcdoc"==e.href&&(e=window.parent.location);var n={};return function(e,t,i){for(;i=t.exec(e);)n[decodeURIComponent(i[1])]=decodeURIComponent(i[2])}(e.search.substring(1).replace(/\+/g,"%20"),/([^&=]+)=?([^&]*)/g),n}();t="referrer"in e?/^https:\/\/medium.com\//.test(e.referrer):!("auto"in e)}return t}function d(e){var t=e||window.innerWidth;return 999<t?650:599<t?575:400}function u(e,t){if(window.top!==window.self){var i=window;if("srcdoc"==i.location.pathname&&(i=i.parent),a)return e=parseInt(e,10),void i.parent.postMessage({sentinel:"amp",type:"embed-size",height:e},"*");var n={sender:"Flourish",context:"iframe.resize",method:"resize",height:e,src:i.location.toString()};if(t)for(var o in t)n[o]=t[o];i.parent.postMessage(JSON.stringify(n),"*")}}function h(){return(-1!==navigator.userAgent.indexOf("Safari")||-1!==navigator.userAgent.indexOf("iPhone"))&&-1==navigator.userAgent.indexOf("Chrome")}function c(o){window.addEventListener("message",function(t){if(null!=t.source&&(t.origin===document.location.origin||t.origin.match(/\/\/localhost:\d+$|\/\/flourish-api\.com$|\.flourish\.(?:local(:\d+)?|rocks|studio)$/))){var e;try{e=JSON.parse(t.data)}catch(e){return void console.warn("Unexpected non-JSON message: "+JSON.stringify(t.data))}if("Flourish"===e.sender){for(var i=document.querySelectorAll("iframe"),n=0;n<i.length;n++)if(i[n].contentWindow==t.source||i[n].contentWindow==t.source.parent)return void o(e,i[n]);console.warn("could not find frame",e)}}}),h()&&(window.addEventListener("resize",e),e())}function e(){for(var e=document.querySelectorAll(".flourish-embed"),t=0;t<e.length;t++){var i=e[t];if(!i.getAttribute("data-width")){var n=i.querySelector("iframe"),o=window.getComputedStyle(i),r=i.offsetWidth-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight);n.style.width=r+"px"}}}function l(e,t,i,n){i&&"number"==typeof i&&(i+="px"),n&&"number"==typeof n&&(n+="px"),n||(e.match(/\?/)?e+="&auto=1":e+="?auto=1",n=d(i)+"px");var o=document.createElement("iframe");return o.setAttribute("scrolling","no"),o.setAttribute("frameborder","0"),o.setAttribute("src",e),t.appendChild(o),i?o.style.width=i:h()?o.style.width=t.offsetWidth+"px":o.style.width="100%",n&&("%"===n.charAt(n.length-1)&&(n=parseFloat(n)/100*t.parentNode.offsetHeight+"px"),o.style.height=n),o}!function(){Flourish.warn=function(e){console.warn(e)};var t,i=window.top===window.self,n=i?null:(a="#amp=1"==window.location.hash,{createEmbedIframe:l,isFixedHeight:s,getHeightForBreakpoint:d,startEventListeners:c,notifyParentWindow:u,isSafari:h}),o=!0;function r(){var e;Flourish.fixed_height||(null!=t?e=t:o&&(e=n.getHeightForBreakpoint()),e!==window.innerHeight&&n.notifyParentWindow(e))}function e(){r(),window.addEventListener("resize",r)}Flourish.uploadImage=function(e){if(i||"story_editor"!==Flourish.environment)throw"Invalid upload request";var t={sender:"Flourish",method:"request-upload",name:e.name,accept:e.accept};window.parent.postMessage(JSON.stringify(t),"*")},Flourish.setHeight=function(e){Flourish.fixed_height||(o=null==(t=e),r())},Flourish.checkHeight=function(){if(!i){var e=Flourish.__container_height;null!=e?(Flourish.fixed_height=!0,n.notifyParentWindow(e)):n.isFixedHeight()?Flourish.fixed_height=!0:(Flourish.fixed_height=!1,r())}},Flourish.fixed_height=i||n.isFixedHeight(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}()}();
//# sourceMappingURL=embedded.js.map
